///$tab Main
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='$ ###0.00;-$ ###0.00';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='M/D/YYYY';
SET TimestampFormat='M/D/YYYY h:mm:ss[.fff] TT';
SET FirstWeekDay=6;
SET BrokenWeeks=1;
SET ReferenceDay=0;
SET FirstMonthOfYear=1;
SET CollationLocale='en-US';
SET CreateSearchIndexOnReload=1;
SET MonthNames='Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec';
SET LongMonthNames='January;February;March;April;May;June;July;August;September;October;November;December';
SET DayNames='Mon;Tue;Wed;Thu;Fri;Sat;Sun';
SET LongDayNames='Monday;Tuesday;Wednesday;Thursday;Friday;Saturday;Sunday';
SET NumericalAbbreviation='3:k;6:M;9:G;12:T;15:P;18:E;21:Z;24:Y;-3:m;-6:Î¼;-9:n;-12:p;-15:f;-18:a;-21:z;-24:y';

///$tab Dimensions
LIB CONNECT TO 'Dev_Space:Snowflake_Sales_Perfomance';

[DIM_EVENT_INDICATOR]:
LOAD EVENT_INDICATOR_ORG, 
	EVENT_INDICATOR_CODE, 
	EVENT_INDICATOR;

SELECT "EVENT_INDICATOR_ORG",
	"EVENT_INDICATOR_CODE",
	"EVENT_INDICATOR"
FROM "MARTS"."SHARED"."DIM_EVENT_INDICATOR";

[DIM_EVENT_TYPES]:
LOAD EVENT_TYPES_ORG, 
	EVENT_TYPE_CODE, 
	EVENT_TYPE;

SELECT "EVENT_TYPES_ORG",
	"EVENT_TYPE_CODE",
	"EVENT_TYPE"
FROM "MARTS"."SHARED"."DIM_EVENT_TYPES";

[DIM_MARKET_SEGMENTS]:
LOAD MAJOR_SEGMENT_CODE, 
	MINOR_SEGMENT_CODE, 
	MARKET_SEGMENT, 
	MARKET_SEGMENT_UOM, 
	MARKET_SEGMENT_ENT_STAMP, 
	MARKET_SEGMENT_USER_ID, 
	MARKET_SEGMENT_UPD_STAMP, 
	MARKET_SEGMENT_UPD_USER_ID, 
	MARKET_SEGMENT_CAT_CODE, 
	MARKET_SEGMENT_CATEGORY, 
	MARKET_SEGMENT_CLASS, 
	MARKET_SEGMENT_GROUP, 	 
	MARKET_SEGMENTS_STAMP;

SELECT "MAJOR_SEGMENT_CODE",
	"MINOR_SEGMENT_CODE",
	"MARKET_SEGMENT",
	"MARKET_SEGMENT_UOM",
	"MARKET_SEGMENT_ENT_STAMP",
	"MARKET_SEGMENT_USER_ID",
	"MARKET_SEGMENT_UPD_STAMP",
	"MARKET_SEGMENT_UPD_USER_ID",
	"MARKET_SEGMENT_CAT_CODE",
	"MARKET_SEGMENT_CATEGORY",
	"MARKET_SEGMENT_CLASS",
	"MARKET_SEGMENT_GROUP",
	"MARKET_SEGMENTS_STAMP"
FROM "MARTS"."SHARED"."DIM_MARKET_SEGMENTS";

[DIM_REVENUE_ELEMENT]:
LOAD REVENUE_ELEMENT_ORG, 
	DEPARTMENT_CODE, 
	REVENUE_ELEMENT_NAME, 
	REVENUE_ELEMENT_STATUS, 
	REVENUE_ELEMENT_UPD_STAMP, 
	REVENUE_ELEMENT_STAMP;

SELECT "REVENUE_ELEMENT_ORG",
	"DEPARTMENT_CODE",
	"REVENUE_ELEMENT_NAME",
	"REVENUE_ELEMENT_STATUS",
	"REVENUE_ELEMENT_UPD_STAMP",
	"REVENUE_ELEMENT_STAMP"
FROM "MARTS"."SHARED"."DIM_REVENUE_ELEMENT";

[DIM_SALESPERSON]:
LOAD SALESPERSON_ORG, 
	SALESPERSON_ACCOUNT_CODE, 
	REDUCTION_EMAIL, 
	SALESPERSON_ACCOUNT_FULL_NAME, 
	SALESPERSON_ACCOUNT_FIRST_NAME, 
	SALESPERSON_ACCOUNT_LAST_NAME, 
	SALESPERSON_DESIGNATION, 
	SALESPERSON_STATUS, 
	SALESPERSON_CLASS;

SELECT "SALESPERSON_ORG",
	"SALESPERSON_ACCOUNT_CODE",
	"REDUCTION_EMAIL",
	"SALESPERSON_ACCOUNT_FULL_NAME",
	"SALESPERSON_ACCOUNT_FIRST_NAME",
	"SALESPERSON_ACCOUNT_LAST_NAME",
	"SALESPERSON_DESIGNATION",
	"SALESPERSON_STATUS",
	"SALESPERSON_CLASS"
FROM "MARTS"."SHARED"."DIM_SALESPERSON";

[DIM_SALES_CHANNEL]:
LOAD LEAD_SOURCE_CODE, 
	LEAD_SOURCE_DESCRIPTION;

SELECT "LEAD_SOURCE_CODE",
	"LEAD_SOURCE_DESCRIPTION"
FROM "MARTS"."SHARED"."DIM_SALES_CHANNEL";

[DIM_SALES_GOAL]:
LOAD SALES_GOAL_ID, 
	SALES_GOAL_ORG, 
	SALES_GOAL_FOR, 
	SALES_GOAL_TYPE_ID, 
	SALES_GOAL_EVENT_ID, 
	SALES_GOAL_REP_ACCOUNT_CODE, 
	SALES_GOAL_TOTAL_AMOUNT, 
	SALES_GOAL_START_YEAR, 
	SALES_GOAL_PERIOD_TYPE, 
	SALES_GOAL_PERIOD, 
	SALES_GOAL_TOTAL_PERIODS, 
	SALES_GOAL_START_DATE, 
	SALES_GOAL_END_DATE, 
	SALES_GOAL_SHOW_TO_TEAM, 
	SALES_GOAL_DEPARTMENT_CODE, 
	SALES_GOAL_ENTERED_STAMP, 
	SALES_GOAL_UPDATED_STAMP, 
	SALES_GOAL_ENTERED_USER, 
	SALES_GOAL_UPDATED_USER, 
	IS_TEAM_GOAL, 
	SALES_GOAL_IS_EVENT_SPECIFIC, 
	SALES_GOAL_DESCRIPTION, 
	SALES_GOAL_TYPE_DESCRIPTION;

SELECT "SALES_GOAL_ID",
	"SALES_GOAL_ORG",
	"SALES_GOAL_FOR",
	"SALES_GOAL_TYPE_ID",
	"SALES_GOAL_EVENT_ID",
	"SALES_GOAL_REP_ACCOUNT_CODE",
	"SALES_GOAL_TOTAL_AMOUNT",
	"SALES_GOAL_START_YEAR",
	"SALES_GOAL_PERIOD_TYPE",
	"SALES_GOAL_PERIOD",
	"SALES_GOAL_TOTAL_PERIODS",
	"SALES_GOAL_START_DATE",
	"SALES_GOAL_END_DATE",
	"SALES_GOAL_SHOW_TO_TEAM",
	"SALES_GOAL_DEPARTMENT_CODE",
	"SALES_GOAL_ENTERED_STAMP",
	"SALES_GOAL_UPDATED_STAMP",
	"SALES_GOAL_ENTERED_USER",
	"SALES_GOAL_UPDATED_USER",
	"IS_TEAM_GOAL",
	"SALES_GOAL_IS_EVENT_SPECIFIC",
	"SALES_GOAL_DESCRIPTION",
	"SALES_GOAL_TYPE_DESCRIPTION"
FROM "MARTS"."SHARED"."DIM_SALES_GOAL";

[DIM_SPACE_DETAILS]:
LOAD SPACE_DETAILS_ORG, 
	SPACE_CODE, 
	SPACE_NAME, 
	SPACE_ABBR, 
	SPACE_TYPE_CODE, 
	SPACE_MAP_URL, 
	SPACE_BASE_COMP_IND, 
	SPACE_MIN_CAPACITY, 
	SPACE_CAPACITY_AMT, 
	SPACE_ACCT_CODE, 
	SPACE_LEAD_HRS, 
	SPACE_STRIKE_HRS, 
	SPACE_UPD_STAMP, 	 
	SPACE_NET_AREA, 
	SPACE_DETAILS_STAMP;

SELECT "SPACE_DETAILS_ORG",
	"SPACE_CODE",
	"SPACE_NAME",
	"SPACE_ABBR",
	"SPACE_TYPE_CODE",
	"SPACE_MAP_URL",
	"SPACE_BASE_COMP_IND",
	"SPACE_MIN_CAPACITY",
	"SPACE_CAPACITY_AMT",
	"SPACE_ACCT_CODE",
	"SPACE_LEAD_HRS",
	"SPACE_STRIKE_HRS",
	"SPACE_UPD_STAMP",
	"SPACE_NET_AREA",
	"SPACE_DETAILS_STAMP"
FROM "MARTS"."SHARED"."DIM_SPACE_DETAILS";

[DIM_SPACE_TYPES]:
LOAD SPACE_TYPE_CODE, 
	SPACE_TYPE, 
	 
	SPACE_TYPES_STAMP;

SELECT "SPACE_TYPE_CODE",
	"SPACE_TYPE",
	"SPACE_TYPES_STAMP"
FROM "MARTS"."SHARED"."DIM_SPACE_TYPES";

[EVENTCLASSES]:
LOAD ID, 
	ORGCODE, 
	CODE, 
	DESCRIPTION;

SELECT "ID",
	"ORGCODE",
	"CODE",
	"DESCRIPTION"
FROM "MARTS"."SHARED"."EVENTCLASSES";


///$tab Facts
LIB CONNECT TO 'Dev_Space:Snowflake_Sales_Perfomance';
//Sales Performance
[FACT_RETENTION_RATE]:
LOAD CUSTOMER_NUMBER, 
	BOOKED_VENUE, 
	BOOKING_MONTH, 
	REDUCTION_EMAIL, 
	YEARS_SINCE_FIRST_BOOKING, 
	TOTAL_MONTHS_BOOKED;

SELECT "CUSTOMER_NUMBER",
	"BOOKED_VENUE",
	"BOOKING_MONTH",
	"REDUCTION_EMAIL",
	"YEARS_SINCE_FIRST_BOOKING",
	"TOTAL_MONTHS_BOOKED"
FROM "MARTS"."SALES_PERFORMANCE"."FACT_RETENTION_RATE";

[FACT_REVENUE]:
LOAD EVENT_START_DATE, 
	EVENT_END_DATE, 
	SALESPERSON_ACCOUNT_CODE, 
	REDUCTION_EMAIL, 
	EVENT_BOOKING_DATE, 
	LEAD_SOURCE_CODE, 
	SPACE_CODE, 
	DEPARTMENT_CODE, 
	ORDER_TYPE, 
	SPACE_TYPE_CODE, 
	EVENT_ID, 
	EVENT_TYPE_CODE, 
	MARKET_SEGMENT, 
	REVENUE_AMOUNT;

SELECT "EVENT_START_DATE",
	"EVENT_END_DATE",
	"SALESPERSON_ACCOUNT_CODE",
	"REDUCTION_EMAIL",
	"EVENT_BOOKING_DATE",
	"LEAD_SOURCE_CODE",
	"SPACE_CODE",
	"DEPARTMENT_CODE",
	"ORDER_TYPE",
	"SPACE_TYPE_CODE",
	"EVENT_ID",
	"EVENT_TYPE_CODE",
	"MARKET_SEGMENT",
	"REVENUE_AMOUNT"
FROM "MARTS"."SALES_PERFORMANCE"."FACT_REVENUE";

[FACT_VENUE_OCCUPANCY]:
LOAD EVENT_ID, 
	SPACE_CODE, 
	REDUCTION_EMAIL, 
	EVENT_BOOKING_DATE, 
	MONTH_START, 
	TOTAL_OCCUPIED_HOURS, 
	TOTAL_DAYS_IN_MONTH, 
	OCCUPANCY_RATE;

SELECT "EVENT_ID",
	"SPACE_CODE",
	"REDUCTION_EMAIL",
	"EVENT_BOOKING_DATE",
	"MONTH_START",
	"TOTAL_OCCUPIED_HOURS",
	"TOTAL_DAYS_IN_MONTH",
	"OCCUPANCY_RATE"
FROM "MARTS"."SALES_PERFORMANCE"."FACT_VENUE_OCCUPANCY";

[MARTS_SALES_PERFORMANCE_RETENTION_RATE]:
LOAD CUSTOMER_NUMBER, 
	BOOKED_VENUE, 
	BOOKING_MONTH, 
	YEARS_SINCE_FIRST_BOOKING, 
	TOTAL_MONTHS_BOOKED;

SELECT "CUSTOMER_NUMBER",
	"BOOKED_VENUE",
	"BOOKING_MONTH",
	"YEARS_SINCE_FIRST_BOOKING",
	"TOTAL_MONTHS_BOOKED"
FROM "MARTS"."SALES_PERFORMANCE"."MARTS_SALES_PERFORMANCE_RETENTION_RATE";

//Revenue Trends

[REVENUE_TRENDS_DETAILS]:
LOAD DEPARTMENT_CODE, 
	PHASE, 
	REDUCTION_EMAIL, 
	EVENT_NAME, 
	EVENT_START_DATE, 
	EVENT_END_DATE, 
	EVENT_TYPE_CODE, 
	MARKET_SEGMENT, 
	SPACE_CODE, 
	SPACE_TYPE_CODE, 
	REVENUE_AMOUNT;

SELECT "DEPARTMENT_CODE",
	"PHASE",
	"REDUCTION_EMAIL",
	"EVENT_NAME",
	"EVENT_START_DATE",
	"EVENT_END_DATE",
	"EVENT_TYPE_CODE",
	"MARKET_SEGMENT",
	"SPACE_CODE",
	"SPACE_TYPE_CODE",
	"REVENUE_AMOUNT"
FROM "MARTS"."REVENUE_TRENDS"."REVENUE_TRENDS_DETAILS";


// Sales Funnel

[CR031_DIARY]:
LOAD CR031_ORG_CODE, 
	CR031_EXT_ACCT_CODE, 
	CR031_UPD_DATE, 
	CR031_DIARY_SEQ, 
	CR031_DIARY_SEQ_CONT, 
	DATE_LOADED, 
	CR031_SEQ_NBR;

SELECT "CR031_ORG_CODE",
	"CR031_EXT_ACCT_CODE",
	"CR031_UPD_DATE",
	"CR031_DIARY_SEQ",
	"CR031_DIARY_SEQ_CONT",
	"DATE_LOADED",
	"CR031_SEQ_NBR"
FROM "MARTS"."SALES_FUNNEL"."CR031_DIARY";

[FACT_EXTENDED_CHARGE]:
LOAD OPPORTUNITY_ID, 
	SALES_QUOTE_ID, 
	OPPORTUNITY_SALES_QUOTE_REVENUE;

SELECT "OPPORTUNITY_ID",
	"SALES_QUOTE_ID",
	"OPPORTUNITY_SALES_QUOTE_REVENUE"
FROM "MARTS"."SALES_FUNNEL"."FACT_EXTENDED_CHARGE";

[FACT_FUNNEL_HEALTH]:
LOAD OPPORTUNITY_ID, 
	EVENT_STATUS_CATEGORY, 
	OPPORTUNITY_PREVIOUS_STATUS, 
	OPPORTUNITY_CURRENT_STATUS, 
	OPPORTUNITY_STATUS_CHANGE_STAMP, 
	OPPORTUNITY_ENT_STAMP, 
	AUDIT_OPPORTUNITY_ID, 
	REDUCTION_EMAIL, 
	STAGE_DURATION_DAYS;

SELECT "OPPORTUNITY_ID",
	"EVENT_STATUS_CATEGORY",
	"OPPORTUNITY_PREVIOUS_STATUS",
	"OPPORTUNITY_CURRENT_STATUS",
	"OPPORTUNITY_STATUS_CHANGE_STAMP",
	"OPPORTUNITY_ENT_STAMP",
	"AUDIT_OPPORTUNITY_ID",
	"REDUCTION_EMAIL",
	"STAGE_DURATION_DAYS"
FROM "MARTS"."SALES_FUNNEL"."FACT_FUNNEL_HEALTH";

[FACT_REVENUE]:
LOAD EVENT_START_DATE, 
	EVENT_END_DATE, 
	SALESPERSON_ACCOUNT_CODE, 
	REDUCTION_EMAIL, 
	PHASE, 
	DEPARTMENT_CODE, 
	ORDER_TYPE, 
	EVENT_ID,  
	REVENUE_AMOUNT, 
	EVENT_STATUS_CODE;

SELECT "EVENT_START_DATE",
	"EVENT_END_DATE",
	"SALESPERSON_ACCOUNT_CODE",
	"REDUCTION_EMAIL",
	"PHASE",
	"DEPARTMENT_CODE",
	"ORDER_TYPE",
	"EVENT_ID",
	"REVENUE_AMOUNT",
	"EVENT_STATUS_CODE"
FROM "MARTS"."SALES_FUNNEL"."FACT_REVENUE";

[SALES_FUNNEL_DETAILS]:
LOAD ACCOUNT_FIRST_NAME, 
	ACCOUNT_LAST_NAME, 
	COMPANY_NAME, 
	REDUCTION_EMAIL, 
	ORGANIZATION_CODE, 
	OPPORTUNITY_ID, 
	OPPORTUNITY_EVENT_ID, 
	OPPORTUNITY_EVENT_TYPE_CODE, 
	OPPORTUNITY_EVENT_STATUS_CODE, 
	OPPORTUNITY_LEAD_SOURCE_CODE, 
	OPPORTUNITY_LOST_REASON_CODE, 
	SALESPERSON, 
	WIN_PROB, 
	ACCOUNT_CODE, 
	OPPORTUNITY_NAME, 
	OPPORTUNITY_TOTAL_ATTENDANCE, 
	ESTIMATE_REVENUE, 
	OPPORTUNITY_START_DATE, 
	OPPORTUNITY_END_DATE, 
	OPPORTUNITY_DATE_BOOKED, 
	OPPORTUNITY_DECISION_DATE, 
	EXISTING_CUSTOMER, 
	TOTAL_GOAL_AMOUNT, 
	SPACE_CODE, 
	SPACE_TYPE_CODE, 
	OPPORTUNITY_UPDATED_DATE;

SELECT "ACCOUNT_FIRST_NAME",
	"ACCOUNT_LAST_NAME",
	"COMPANY_NAME",
	"REDUCTION_EMAIL",
	"ORGANIZATION_CODE",
	"OPPORTUNITY_ID",
	"OPPORTUNITY_EVENT_ID",
	"OPPORTUNITY_EVENT_TYPE_CODE",
	"OPPORTUNITY_EVENT_STATUS_CODE",
	"OPPORTUNITY_LEAD_SOURCE_CODE",
	"OPPORTUNITY_LOST_REASON_CODE",
	"SALESPERSON",
	"WIN_PROB",
	"ACCOUNT_CODE",
	"OPPORTUNITY_NAME",
	"OPPORTUNITY_TOTAL_ATTENDANCE",
	"ESTIMATE_REVENUE",
	"OPPORTUNITY_START_DATE",
	"OPPORTUNITY_END_DATE",
	"OPPORTUNITY_DATE_BOOKED",
	"OPPORTUNITY_DECISION_DATE",
	"EXISTING_CUSTOMER",
	"TOTAL_GOAL_AMOUNT",
	"SPACE_CODE",
	"SPACE_TYPE_CODE",
	"OPPORTUNITY_UPDATED_DATE"
FROM "MARTS"."SALES_FUNNEL"."SALES_FUNNEL_DETAILS";


